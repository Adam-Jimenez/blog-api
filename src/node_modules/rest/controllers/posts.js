const db = require('db')
const errors = require('errors')

module.exports = {
    getAllPosts: (req, res) => {
        db.Post.findAll()
        .then((posts) => {
            res.json(posts)
        })
        .catch(errors.handleRestError(req, res))
    },
    getLatestPost: (req, res) => {
        db.Post.findOne({ order:'`created_at` DESC'})
        .then((post) => {
            res.json(post)
        })
        .catch(errors.handleRestError(req, res))
    },
    getPostById: (req, res) => {
        db.Post.findById(req.params.id)
        .then((post) => {
            res.json(post)
        })
        .catch(errors.handleRestError(req, res))
    },
    createPost: (req, res) => {
        db.Post.create({
            title: req.body.title,
            content: req.body.content
        })
        .then((post) => {
            res.json(post)
        })
        .catch(errors.handleRestError(req, res))
    }
}
