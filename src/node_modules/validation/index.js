const htmlparser = require('htmlparser2')
const _ = require('lodash')
module.exports = {
    validateHtml: (html, allowedTags, allowedAttributes) => {
            allowedTags = allowedTags || [
                'p',
                'strong',
                'ol',
                'ul',
                'pre',
                'br',
                'li',
                'em',
                'u'
            ]

            allowedAttributes = allowedAttributes || []

            let htmlIsValid = true

            const parser = new htmlparser.Parser({
                onopentag: (name, attributes) => {
                    if (allowedTags.indexOf(name) === -1) {
                        htmlIsValid = false
                    }
                    _.each(attributes, (value, attribute) => {
                        if (allowedAttributes.indexOf(attribute) === -1) {
                            htmlIsValid = false
                        }
                    })
                }
            })
            parser.write(html)
            parser.end()
            return htmlIsValid
    }
}
