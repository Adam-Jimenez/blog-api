const _ = require('lodash')

module.exports = {
    env: 'production',
    port: 3000,
    adminPassword: process.env.ADMIN_PASS,
    database: {
        schemaName: 'blog',
        username: process.env.DB_USER,
        password: process.env.DB_PASS || ''
    },
    mail: {
        user: process.env.MAIL_USER || '',
        adminMail: process.env.ADMIN_MAIL || ''
    },
    https: {
        active: true,
        privateKeyPath: process.env.HTTPS_PRIVATE_KEY,
        certificatePath: process.env.HTTPS_CERTIFICATE
    },
    validateConfig: () => {
        // TODO: maybe validate with joi
        const requiredEnvironnementVariables = ['ADMIN_PASS', 'DB_USER', 'HTTPS_PRIVATE_KEY', 'HTTPS_CERTIFICATE']

        _.each(requiredEnvironnementVariables, (variable) => {
            if (!process.env[variable]) {
                throw new Error(`Environnement variable ${variable} is not set`)
            }
        })
    }
}
